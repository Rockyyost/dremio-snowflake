#
# Copyright (C) 2017-2019 Dremio Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

metadata:
  # Manually Configured Metadata Section.
  name: SNOWFLAKE
  apiname: snowflake
  spec_version: '1.1'

syntax:
  # Manually Configured Syntax Section.
  identifier_quote: '"' #https://docs.snowflake.net/manuals/sql-reference/identifiers-syntax.html#double-quoted-identifiers
  identifier_length_limit: 256 #https://docs.snowflake.net/manuals/sql-reference/identifiers.html#object-identifiers
  allows_boolean_literal: false
  map_boolean_literal_to_bit: false
  supports_catalogs: false
  supports_schemas: false

# https://docs.snowflake.net/manuals/sql-reference/intro-summary-data-types.html
data_types:
  mappings:
    #------------Numeric types--------------#
    - source:
        name: "NUMERIC"
        max_scale: 38
      required_cast_args: "precision_scale"
      dremio:
        name: "double"
    - source:
        name: "NUMBER"
        max_scale: 38
      required_cast_args: "precision_scale"
      dremio:
        name: "double"
    - source:
        name: "DECIMAL"
        max_scale: 38
      required_cast_args: "precision_scale"
      dremio:
        name: "double"

    - source:
        name: "INT"
      dremio:
        name: "integer"
    - source:
        name: "INTEGER"
      dremio:
        name: "integer"
    - source:
        name: "SMALLINT"
      dremio:
        name: "integer"
    - source:
        name: "BIGINT"
      dremio:
        name: "bigint"

    - source:
        name: "FLOAT"
      dremio:
        name: "double"
    - source:
        name: "FLOAT4"
      dremio:
        name: "double"
    - source:
        name: "FLOAT8"
      dremio:
        name: "double"
    - source:
        name: "DOUBLE"
      dremio:
        name: "double"
    - source:
        name: "DOUBLE PRECISION"
      dremio:
        name: "double"

    #------------String types--------------#
    - source:
        name: "VARCHAR"
        max_precision: 16777216
        literal_length_limit: 16777216
      required_cast_args: "precision"
      dremio:
        name: "varchar"
    - source:
        name: "CHAR"
        max_precision: 1
        literal_length_limit: 1
      dremio:
        name: "varchar"
    - source:
        name: "CHARACTER"
        max_precision: 1
        literal_length_limit: 1
      dremio:
        name: "varchar"
    - source:
        name: "STRING"
      dremio:
        name: "varchar"

    #------------Date types--------------#
    - source:
        name: "DATE"
      dremio:
        name: "date"
    - source:
        name: "TIME"
      dremio:
        name: "time"
    - source:
        name: "TIMESTAMP"
      dremio:
        name: "timestamp"
    - source:
        name: "TIMESTAMP_LTZ"
      dremio:
        name: "timestamp"
    - source:
        name: "TIMESTAMP_NTZ"
      dremio:
        name: "timestamp"
    - source:
        name: "TIMESTAMP_TZ"
      dremio:
        name: "timestamp"
    - source:
        name: "TIMESTAMPLTZ"
      dremio:
        name: "timestamp"
    - source:
        name: "TIMESTAMPNTZ"
      dremio:
        name: "timestamp"
    - source:
        name: "TIMESTAMPTZ"
      dremio:
        name: "timestamp"

relational_algebra:
  aggregation:
    enable: true
    group_by_ordinal: false
    distinct: true
    count_functions:
      count_star:
        enable: true
      count:
        enable: true
      count_distinct:
        enable: true
    #   https://docs.snowflake.net/manuals/sql-reference-functions.html

    functions:
      - names:
          - "avg"
        signatures:
          - args:
              - "double"
            return: "double"
          - args:
              - "integer"
            return: "double"
      - names:
          - "max"
          - "min"
        signatures:
          - args:
              - "integer"
            return: "integer"
          - args:
              - "double"
            return: "double"
          - args:
              - "varchar"
            return: "varchar"
      - names:
          - "sum"
        signatures:
          - args:
              - "double"
            return: "double"
          - args:
              - "integer"
            return: "bigint"

  except:
    enable: false
  project:
    enable: true
  join:
    enable: true
    cross:
      enable: true
      rewrite: "{0}, {1}"
    inner:
      enable: true
      inequality: true
    left:
      enable: true
      inequality: true
    right:
      enable: true
      inequality: true
    full:
      enable: true
      inequality: true
  sort:
    enable: true
    order_by:
      enable: true
      default_nulls_ordering: high
    fetch_offset: # https://docs.snowflake.net/manuals/sql-reference/constructs/limit.html#limit-fetch
      offset_fetch:
        enable: true
        format: 'LIMIT {1} OFFSET {0}'
      offset_only:
        enable: false
      fetch_only:
        enable: true
        format: 'LIMIT {0}'
  # https://docs.snowflake.net/manuals/sql-reference/operators-query.html#union-all
  union:
    enable: true
  union_all:
    enable: true
  values:
    enable: false
    method: values

# Describe the set of function signatures that are internally supported.
expressions:
  subqueries:
    enable: true
    correlated: true
    scalar: true
    in_clause: true
  supports_case: true
  supports_over: true
  operators:
    # Custom Expressions
    - names:
        - "cast"
      signatures:
        - args:
            - "varchar"
          return: "integer"
          rewrite: "CAST(TRUNC(CAST({0} AS DECIMAL), 0) AS INTEGER)"
        - args:
            - "varchar"
          return: "bigint"
          rewrite: "CAST(TRUNC(CAST({0} AS DECIMAL), 0) AS BIGINT)"
    - names:
        - "trim" #https://docs.snowflake.net/manuals/sql-reference/functions/trim.html
      signatures:
        - args:
            - "varchar"
          return: "varchar"
    - names: #https://docs.snowflake.net/manuals/sql-reference/functions/ltrim.html
        - "ltrim"
      signatures:
        - args:
            - "varchar"
          return: "varchar"
    - names: #https://docs.snowflake.net/manuals/sql-reference/functions/rtrim.html
        - "rtrim"
      signatures:
        - args:
            - "varchar"
          return: "varchar"
    - names: #https://docs.snowflake.net/manuals/sql-reference/functions/sign.html
        - "sign"
      signatures:
        - args:
            - "bigint"
          return: "bigint"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "float"
        - args:
            - "integer"
          return: "integer"
    - names:
        - "floor" #https://docs.snowflake.net/manuals/sql-reference/functions/floor.html.
      signatures:
        - args:
            - "bigint"
          return: "bigint"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "float"
        - args:
            - "integer"
          return: "integer"
    - names:
        - "position"
        - "locate"
      signatures:
        - args:
            - "varchar"
            - "varchar"
          return: "integer"
          rewrite: "STRPOS({1}, {0})"
        - args:
            - "varchar"
            - "varchar"
            - "integer"
          return: "integer"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL OR {2} IS NULL THEN NULL WHEN STRPOS(SUBSTRING({1}, {2}), {0}) > 0 THEN CASE WHEN {2} >= 1 THEN STRPOS(SUBSTRING({1}, {2}), {0}) + {2} - 1 ELSE STRPOS({1}, {0}) END ELSE 0 END "
        - args:
            - "varchar"
            - "varchar"
            - "bigint"
          return: "integer"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL OR {2} IS NULL THEN NULL WHEN STRPOS(SUBSTRING({1}, {2}), {0}) > 0 THEN CASE WHEN {2} >= 1 THEN STRPOS(SUBSTRING({1}, {2}), {0}) + {2} - 1 ELSE STRPOS({1}, {0}) END ELSE 0 END "
    - names:
        - "pi"
      signatures:
        - args: []
          return: "double"
    - names:
        - "truncate"
      signatures:
        - args:
            - "double"
            - "integer"
          return: "double"
          rewrite: "TRUNC(CAST({0} as decimal), {1})"
        - args:
            - "float"
            - "integer"
          return: "float"
          rewrite: "TRUNC(CAST({0} as decimal), {1})"
        - args:
            - "bigint"
            - "integer"
          return: "bigint"
          rewrite: "TRUNC({0}, {1})"
        - args:
            - "integer"
            - "integer"
          return: "integer"
          rewrite: "TRUNC({0}, {1})"
        - args:
            - "double"
          return: "double"
          rewrite: "TRUNC(CAST({0} as decimal))"
        - args:
            - "float"
          return: "float"
          rewrite: "TRUNC(CAST({0} as decimal))"
        - args:
            - "integer"
          return: "integer"
          rewrite: "TRUNC({0})"
        - args:
            - "bigint"
          return: "bigint"
          rewrite: "TRUNC({0})"
    - names:
        - "reverse"
      signatures:
        - args:
            - "varchar"
          return: "varchar"
    - names:
        - "rpad"
      signatures:
        - args:
            - "varchar"
            - "integer"
          return: "varchar"
          rewrite: "RPAD({0}, {1}, '' '')"
        - args:
            - "varchar"
            - "bigint"
          return: "varchar"
          rewrite: "RPAD({0}, {1}, '' '')"
        - args:
            - "varchar"
            - "integer"
            - "varchar"
          return: "varchar"
        - args:
            - "varchar"
            - "bigint"
            - "varchar"
          return: "varchar"
    - names:
        - "lpad"
      signatures:
        - args:
            - "varchar"
            - "integer"
          return: "varchar"
          rewrite: "LPAD({0}, {1}, '' '')"
        - args:
            - "varchar"
            - "bigint"
          return: "varchar"
          rewrite: "LPAD({0}, {1}, '' '')"
        - args:
            - "varchar"
            - "integer"
            - "varchar"
          return: "varchar"
        - args:
            - "varchar"
            - "bigint"
            - "varchar"
          return: "varchar"
    - names:
        - extract_year
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(YEAR FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(YEAR FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(YEAR FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(YEAR FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(YEAR FROM {0}) AS INT)"
    - names:
        - extract_month
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(MONTH FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(MONTH FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(MONTH FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(MONTH FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(MONTH FROM {0}) AS INT)"
    - names:
        - extract_day
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(DAY FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(DAY FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(DAY FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(DAY FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(DAY FROM {0}) AS INT)"
    - names:
        - extract_hour
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(HOUR FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(HOUR FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(HOUR FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(HOUR FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(HOUR FROM {0}) AS INT)"
    - names:
        - extract_minute
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(MINUTE FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(MINUTE FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(MINUTE FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(MINUTE FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(MINUTE FROM {0}) AS INT)"
    - names:
        - extract_second
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(SECOND FROM DATE_TRUNC(''SECOND'', {0})) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(SECOND FROM DATE_TRUNC(''SECOND'', {0})) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(SECOND FROM DATE_TRUNC(''SECOND'', {0})) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(SECOND FROM DATE_TRUNC(''SECOND'', {0})) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(SECOND FROM DATE_TRUNC(''SECOND'', {0})) AS INT)"
    - names:
        - extract_century
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(CENTURY FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(CENTURY FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(CENTURY FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(CENTURY FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(CENTURY FROM {0}) AS INT)"
    - names:
        - extract_decade
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(DECADE FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(DECADE FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(DECADE FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(DECADE FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(DECADE FROM {0}) AS INT)"
    - names:
        - extract_dow
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(DOW FROM {0}) + 1 AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(DOW FROM {0}) + 1 AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(DOW FROM {0}) + 1 AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(DOW FROM {0}) + 1 AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(DOW FROM {0}) + 1 AS INT)"
    - names:
        - extract_doy
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(DOY FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(DOY FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(DOY FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(DOY FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(DOY FROM {0}) AS INT)"
    - names:
        - extract_epoch
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(EPOCH FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(EPOCH FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(EPOCH FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(EPOCH FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(EPOCH FROM {0}) AS INT)"
    - names:
        - extract_quarter
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(QUARTER FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(QUARTER FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(QUARTER FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(QUARTER FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(QUARTER FROM {0}) AS INT)"
    - names:
        - extract_week
      signatures:
        - return: bigint
          args:
            - date
          rewrite: "CAST(EXTRACT(WEEK FROM {0}) AS INT)"
        - return: bigint
          args:
            - timestamp
          rewrite: "CAST(EXTRACT(WEEK FROM {0}) AS INT)"
        - return: bigint
          args:
            - time
          rewrite: "CAST(EXTRACT(WEEK FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_year_month
          rewrite: "CAST(EXTRACT(WEEK FROM {0}) AS INT)"
        - return: bigint
          args:
            - interval_day_second
          rewrite: "CAST(EXTRACT(WEEK FROM {0}) AS INT)"
    - names:
        - "-"
      signatures:
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "double"
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "integer"
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "bigint"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "double"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "integer"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "bigint"
        - args:
            - "timestamp"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "timestamp"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "date"
            - "interval_day_second"
          return: "date"
        - args:
            - "date"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "date"
            - "interval_year_month"
          return: "date"
        - args:
            - "date"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "time"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "time"
            - "interval_year_month"
          return: "timestamp"
    - names:
        - "+"
      signatures:
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "double"
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "integer"
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "bigint"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "double"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "integer"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "bigint"
        - args:
            - "timestamp"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "timestamp"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "date"
            - "interval_day_second"
          return: "date"
        - args:
            - "date"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "date"
            - "interval_year_month"
          return: "date"
        - args:
            - "date"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "time"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "time"
            - "interval_year_month"
          return: "timestamp"
    - names:
        - "/"
      signatures:
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "double"
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "integer"
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "bigint"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "double"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "integer"
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "bigint"
        - args:
            - "timestamp"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "timestamp"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "date"
            - "interval_day_second"
          return: "date"
        - args:
            - "date"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "date"
            - "interval_year_month"
          return: "date"
        - args:
            - "date"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "time"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "time"
            - "interval_year_month"
          return: "timestamp"
    - names:
        - "*"
      signatures:
        - args:
            - "interval_day_second"
            - "integer"
          return: "interval_day_second"
        - args:
            - "interval_day_second"
            - "bigint"
          return: "interval_day_second"
        - args:
            - "interval_day_second"
            - "double"
          return: "interval_day_second"
        - args:
            - "interval_day_second"
            - "float"
          return: "interval_day_second"
        - args:
            - "interval_year_month"
            - "integer"
          return: "interval_year_month"
        - args:
            - "interval_year_month"
            - "bigint"
          return: "interval_year_month"
        - args:
            - "interval_year_month"
            - "double"
          return: "interval_year_month"
        - args:
            - "interval_year_month"
            - "float"
          return: "interval_year_month"
        - args:
            - "timestamp"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "timestamp"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "date"
            - "interval_day_second"
          return: "date"
        - args:
            - "date"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "date"
            - "interval_year_month"
          return: "date"
        - args:
            - "date"
            - "interval_year_month"
          return: "timestamp"
        - args:
            - "time"
            - "interval_day_second"
          return: "timestamp"
        - args:
            - "time"
            - "interval_year_month"
          return: "timestamp"
    - names:
        - "%"
      signatures:
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "integer"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "interval_day_second"
            - "interval_day_second"
          return: "bigint"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "integer"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "interval_year_month"
            - "interval_year_month"
          return: "bigint"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "timestamp"
            - "interval_day_second"
          return: "timestamp"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "timestamp"
            - "interval_year_month"
          return: "timestamp"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "date"
            - "interval_day_second"
          return: "date"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "date"
            - "interval_day_second"
          return: "timestamp"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "date"
            - "interval_year_month"
          return: "date"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "date"
            - "interval_year_month"
          return: "timestamp"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "time"
            - "interval_day_second"
          return: "timestamp"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "time"
            - "interval_year_month"
          return: "timestamp"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "double"
            - "bigint"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "double"
            - "double"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "integer"
            - "double"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "bigint"
            - "bigint"
          return: "bigint"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "integer"
            - "integer"
          return: "integer"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "bigint"
            - "double"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "bigint"
            - "integer"
          return: "bigint"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "double"
            - "integer"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
        - args:
            - "integer"
            - "bigint"
          return: "bigint"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE ({0} % {1}) END "
    - names:
        - "-"
      signatures:
        - args:
            - "integer"
          return: "integer"
        - args:
            - "bigint"
          return: "bigint"
        - args:
            - "float"
          return: "float"
        - args:
            - "double"
          return: "double"
        - args:
            - "interval_day_second"
          return: "interval_day_second"
        - args:
            - "interval_year_month"
          return: "interval_year_month"
    - names:
        - "+"
      signatures:
        - args:
            - "integer"
          return: "integer"
        - args:
            - "bigint"
          return: "bigint"
        - args:
            - "float"
          return: "float"
        - args:
            - "double"
          return: "double"
        - args:
            - "interval_day_second"
          return: "interval_day_second"
        - args:
            - "interval_year_month"
          return: "interval_year_month"

    - names:
        - "log10"
      signatures:
        - args:
            - "double"
          return: "double"
          rewrite: "LOG({0})"
        - args:
            - "bigint"
          return: "double"
          rewrite: "LOG({0})"
        - args:
            - "integer"
          return: "double"
          rewrite: "LOG({0})"
    - names:
        - "acos"
      signatures:
        - args:
            - "double"
          return: "double"
    - names:
        - "asin"
      signatures:
        - args:
            - "double"
          return: "double"
    - names:
        - "exp"
      signatures:
        - args:
            - "double"
          return: "double"
    - names:
        - "round"
      signatures:
        - args:
            - "integer"
          return: "integer"
        - args:
            - "bigint"
          return: "bigint"
        - args:
            - "double"
          return: "double"
          rewrite: "ROUND(CAST({0} as decimal))"
        - args:
            - "float"
          return: "float"
          rewrite: "ROUND(CAST({0} as decimal))"
        - args:
            - "bigint"
            - "integer"
          return: "bigint"
        - args:
            - "bigint"
            - "bigint"
          return: "bigint"
        - args:
            - "integer"
            - "integer"
          return: "integer"
        - args:
            - "integer"
            - "bigint"
          return: "integer"
        - args:
            - "double"
            - "integer"
          return: "double"
          rewrite: "ROUND(CAST({0} as decimal), {1})"
        - args:
            - "double"
            - "bigint"
          return: "double"
          rewrite: "ROUND(CAST({0} as decimal), {1})"
        - args:
            - "float"
            - "integer"
          return: "float"
          rewrite: "ROUND(CAST({0} as decimal), {1})"
        - args:
            - "float"
            - "bigint"
          return: "float"
          rewrite: "ROUND(CAST({0} as decimal), {1})"
    # Modified Expressions

    # Generated expressions

    - names:
        - "-"
      signatures:
        - args:
            - "bigint"
            - "float"
          return: "float"
        - args:
            - "timestamp"
            - "time"
          return: "timestamp"
        - args:
            - "double"
            - "bigint"
          return: "double"
        - args:
            - "double"
            - "double"
          return: "double"
        - args:
            - "integer"
            - "double"
          return: "double"
        - args:
            - "date"
            - "date"
          return: "integer"
        - args:
            - "float"
            - "float"
          return: "float"
        - args:
            - "float"
            - "integer"
          return: "float"
        - args:
            - "bigint"
            - "bigint"
          return: "bigint"
        - args:
            - "integer"
            - "integer"
          return: "integer"
        - args:
            - "bigint"
            - "integer"
          return: "bigint"
        - args:
            - "double"
            - "float"
          return: "double"
        - args:
            - "integer"
            - "float"
          return: "float"
        - args:
            - "integer"
            - "bigint"
          return: "bigint"
        - args:
            - "float"
            - "bigint"
          return: "float"
        - args:
            - "date"
            - "integer"
          return: "date"
        - args:
            - "float"
            - "double"
          return: "double"
        - args:
            - "bigint"
            - "double"
          return: "double"
        - args:
            - "double"
            - "integer"
          return: "double"
        - args:
            - "time"
            - "time"
          return: "time"
        - args:
            - "date"
            - "time"
          return: "timestamp"
    - names:
        - "+"
      signatures:
        - args:
            - "bigint"
            - "float"
          return: "float"
        - args:
            - "timestamp"
            - "time"
          return: "timestamp"
        - args:
            - "double"
            - "bigint"
          return: "double"
        - args:
            - "double"
            - "double"
          return: "double"
        - args:
            - "integer"
            - "double"
          return: "double"
        - args:
            - "float"
            - "float"
          return: "float"
        - args:
            - "float"
            - "integer"
          return: "float"
        - args:
            - "bigint"
            - "bigint"
          return: "bigint"
        - args:
            - "integer"
            - "integer"
          return: "integer"
        - args:
            - "time"
            - "date"
          return: "timestamp"
        - args:
            - "bigint"
            - "integer"
          return: "bigint"
        - args:
            - "double"
            - "float"
          return: "double"
        - args:
            - "integer"
            - "float"
          return: "float"
        - args:
            - "integer"
            - "bigint"
          return: "bigint"
        - args:
            - "float"
            - "bigint"
          return: "float"
        - args:
            - "integer"
            - "date"
          return: "date"
        - args:
            - "date"
            - "integer"
          return: "date"
        - args:
            - "float"
            - "double"
          return: "double"
        - args:
            - "bigint"
            - "double"
          return: "double"
        - args:
            - "time"
            - "timestamp"
          return: "timestamp"
        - args:
            - "double"
            - "integer"
          return: "double"
        - args:
            - "time"
            - "time"
          return: "time"
        - args:
            - "date"
            - "time"
          return: "timestamp"
    - names:
        - "/"
      signatures:
        - args:
            - "bigint"
            - "float"
          return: "double"
          rewrite: "(CAST({0} AS DOUBLE PRECISION) / {1})"
        - args:
            - "double"
            - "bigint"
          return: "double"
        - args:
            - "double"
            - "double"
          return: "double"
        - args:
            - "integer"
            - "double"
          return: "double"
          rewrite: "(CAST({0} AS DOUBLE PRECISION) / {1})"
        - args:
            - "float"
            - "float"
          return: "double"
        - args:
            - "float"
            - "integer"
          return: "float"
        - args:
            - "bigint"
            - "bigint"
          return: "bigint"
        - args:
            - "integer"
            - "integer"
          return: "integer"
        - args:
            - "bigint"
            - "integer"
          return: "bigint"
        - args:
            - "double"
            - "float"
          return: "double"
        - args:
            - "integer"
            - "float"
          return: "float"
          rewrite: "(CAST({0} AS DOUBLE PRECISION) / {1})"
        - args:
            - "integer"
            - "bigint"
          return: "bigint"
        - args:
            - "float"
            - "bigint"
          return: "double"
        - args:
            - "float"
            - "double"
          return: "double"
        - args:
            - "bigint"
            - "double"
          return: "double"
          rewrite: "(CAST({0} AS DOUBLE PRECISION) / {1})"
        - args:
            - "double"
            - "integer"
          return: "double"
    - names:
        - "*"
      signatures:
        - args:
            - "bigint"
            - "float"
          return: "double"
        - args:
            - "double"
            - "bigint"
          return: "double"
        - args:
            - "double"
            - "double"
          return: "double"
        - args:
            - "integer"
            - "double"
          return: "double"
        - args:
            - "float"
            - "float"
          return: "double"
        - args:
            - "float"
            - "integer"
          return: "double"
        - args:
            - "integer"
            - "integer"
          return: "integer"
        - args:
            - "bigint"
            - "integer"
          return: "bigint"
        - args:
            - "double"
            - "float"
          return: "double"
        - args:
            - "integer"
            - "float"
          return: "double"
        - args:
            - "integer"
            - "bigint"
          return: "bigint"
        - args:
            - "float"
            - "bigint"
          return: "double"
        - args:
            - "float"
            - "double"
          return: "double"
        - args:
            - "bigint"
            - "double"
          return: "double"
        - args:
            - "double"
            - "integer"
          return: "double"
    - names:
        - "is null"
      signatures:
        - args:
            - "float"
          return: "boolean"
        - args:
            - "integer"
          return: "boolean"
        - args:
            - "time"
          return: "boolean"
        - args:
            - "varbinary"
          return: "boolean"
        - args:
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
          return: "boolean"
        - args:
            - "date"
          return: "boolean"
        - args:
            - "double"
          return: "boolean"
        - args:
            - "varchar"
          return: "boolean"
        - args:
            - "bigint"
          return: "boolean"
    - names:
        - "is not null"
      signatures:
        - args:
            - "float"
          return: "boolean"
        - args:
            - "integer"
          return: "boolean"
        - args:
            - "time"
          return: "boolean"
        - args:
            - "varbinary"
          return: "boolean"
        - args:
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
          return: "boolean"
        - args:
            - "date"
          return: "boolean"
        - args:
            - "double"
          return: "boolean"
        - args:
            - "varchar"
          return: "boolean"
        - args:
            - "bigint"
          return: "boolean"
    - names:
        - "="
      signatures:
        - args:
            - "double"
            - "float"
          return: "boolean"
        - args:
            - "integer"
            - "integer"
          return: "boolean"
        - args:
            - "date"
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
        - args:
            - "date"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "float"
          return: "boolean"
        - args:
            - "bigint"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "integer"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
        - args:
            - "bigint"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "bigint"
          return: "boolean"
        - args:
            - "timestamp"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "bigint"
          return: "boolean"
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "integer"
            - "double"
          return: "boolean"
        - args:
            - "float"
            - "float"
          return: "boolean"
        - args:
            - "time"
            - "time"
          return: "boolean"
        - args:
            - "bigint"
            - "float"
          return: "boolean"
        - args:
            - "float"
            - "double"
          return: "boolean"
        - args:
            - "bigint"
            - "double"
          return: "boolean"
        - args:
            - "timestamp"
            - "timestamp"
          return: "boolean"
        - args:
            - "double"
            - "double"
          return: "boolean"
    - names:
        - "!="
      signatures:
        - args:
            - "double"
            - "float"
          return: "boolean"
        - args:
            - "integer"
            - "integer"
          return: "boolean"
        - args:
            - "date"
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
        - args:
            - "date"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "float"
          return: "boolean"
        - args:
            - "bigint"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "integer"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
        - args:
            - "bigint"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "bigint"
          return: "boolean"
        - args:
            - "timestamp"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "bigint"
          return: "boolean"
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "integer"
            - "double"
          return: "boolean"
        - args:
            - "float"
            - "float"
          return: "boolean"
        - args:
            - "time"
            - "time"
          return: "boolean"
        - args:
            - "bigint"
            - "float"
          return: "boolean"
        - args:
            - "float"
            - "double"
          return: "boolean"
        - args:
            - "bigint"
            - "double"
          return: "boolean"
        - args:
            - "timestamp"
            - "timestamp"
          return: "boolean"
        - args:
            - "double"
            - "double"
          return: "boolean"
    - names:
        - "<>"
      signatures:
        - args:
            - "double"
            - "float"
          return: "boolean"
        - args:
            - "integer"
            - "integer"
          return: "boolean"
        - args:
            - "date"
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
        - args:
            - "date"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "float"
          return: "boolean"
        - args:
            - "bigint"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "integer"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
        - args:
            - "bigint"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "bigint"
          return: "boolean"
        - args:
            - "timestamp"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "bigint"
          return: "boolean"
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "integer"
            - "double"
          return: "boolean"
        - args:
            - "float"
            - "float"
          return: "boolean"
        - args:
            - "time"
            - "time"
          return: "boolean"
        - args:
            - "bigint"
            - "float"
          return: "boolean"
        - args:
            - "float"
            - "double"
          return: "boolean"
        - args:
            - "bigint"
            - "double"
          return: "boolean"
        - args:
            - "timestamp"
            - "timestamp"
          return: "boolean"
        - args:
            - "double"
            - "double"
          return: "boolean"
    - names:
        - ">"
      signatures:
        - args:
            - "double"
            - "float"
          return: "boolean"
        - args:
            - "integer"
            - "integer"
          return: "boolean"
        - args:
            - "date"
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
        - args:
            - "date"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "float"
          return: "boolean"
        - args:
            - "bigint"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "integer"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
        - args:
            - "bigint"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "bigint"
          return: "boolean"
        - args:
            - "timestamp"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "bigint"
          return: "boolean"
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "integer"
            - "double"
          return: "boolean"
        - args:
            - "float"
            - "float"
          return: "boolean"
        - args:
            - "time"
            - "time"
          return: "boolean"
        - args:
            - "bigint"
            - "float"
          return: "boolean"
        - args:
            - "float"
            - "double"
          return: "boolean"
        - args:
            - "bigint"
            - "double"
          return: "boolean"
        - args:
            - "timestamp"
            - "timestamp"
          return: "boolean"
        - args:
            - "double"
            - "double"
          return: "boolean"
    - names:
        - ">="
      signatures:
        - args:
            - "double"
            - "float"
          return: "boolean"
        - args:
            - "integer"
            - "integer"
          return: "boolean"
        - args:
            - "date"
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
        - args:
            - "date"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "float"
          return: "boolean"
        - args:
            - "bigint"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "integer"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
        - args:
            - "bigint"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "bigint"
          return: "boolean"
        - args:
            - "timestamp"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "bigint"
          return: "boolean"
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "integer"
            - "double"
          return: "boolean"
        - args:
            - "float"
            - "float"
          return: "boolean"
        - args:
            - "time"
            - "time"
          return: "boolean"
        - args:
            - "bigint"
            - "float"
          return: "boolean"
        - args:
            - "float"
            - "double"
          return: "boolean"
        - args:
            - "bigint"
            - "double"
          return: "boolean"
        - args:
            - "timestamp"
            - "timestamp"
          return: "boolean"
        - args:
            - "double"
            - "double"
          return: "boolean"
    - names:
        - "<"
      signatures:
        - args:
            - "double"
            - "float"
          return: "boolean"
        - args:
            - "integer"
            - "integer"
          return: "boolean"
        - args:
            - "date"
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
        - args:
            - "date"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "float"
          return: "boolean"
        - args:
            - "bigint"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "integer"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
        - args:
            - "bigint"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "bigint"
          return: "boolean"
        - args:
            - "timestamp"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "bigint"
          return: "boolean"
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "integer"
            - "double"
          return: "boolean"
        - args:
            - "float"
            - "float"
          return: "boolean"
        - args:
            - "time"
            - "time"
          return: "boolean"
        - args:
            - "bigint"
            - "float"
          return: "boolean"
        - args:
            - "float"
            - "double"
          return: "boolean"
        - args:
            - "bigint"
            - "double"
          return: "boolean"
        - args:
            - "timestamp"
            - "timestamp"
          return: "boolean"
        - args:
            - "double"
            - "double"
          return: "boolean"
    - names:
        - "<="
      signatures:
        - args:
            - "double"
            - "float"
          return: "boolean"
        - args:
            - "integer"
            - "integer"
          return: "boolean"
        - args:
            - "date"
            - "timestamp"
          return: "boolean"
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
        - args:
            - "date"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "float"
          return: "boolean"
        - args:
            - "bigint"
            - "integer"
          return: "boolean"
        - args:
            - "float"
            - "integer"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
        - args:
            - "bigint"
            - "bigint"
          return: "boolean"
        - args:
            - "integer"
            - "bigint"
          return: "boolean"
        - args:
            - "timestamp"
            - "date"
          return: "boolean"
        - args:
            - "double"
            - "bigint"
          return: "boolean"
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "integer"
            - "double"
          return: "boolean"
        - args:
            - "float"
            - "float"
          return: "boolean"
        - args:
            - "time"
            - "time"
          return: "boolean"
        - args:
            - "bigint"
            - "float"
          return: "boolean"
        - args:
            - "float"
            - "double"
          return: "boolean"
        - args:
            - "bigint"
            - "double"
          return: "boolean"
        - args:
            - "timestamp"
            - "timestamp"
          return: "boolean"
        - args:
            - "double"
            - "double"
          return: "boolean"
    - names:
        - "like"
      signatures:
        - args:
            - "varchar"
            - "varchar"
          return: "boolean"
        - args:
            - "varbinary"
            - "varbinary"
          return: "boolean"
    - names:
        - "not"
      signatures:
        - args:
            - "boolean"
          return: "boolean"
    - names:
        - "||"
      signatures:
        - args:
            - "time"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "date"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "float"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "timestamp"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "integer"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "boolean"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "varbinary"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "time"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "boolean"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "double"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "float"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "bigint"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varbinary"
            - "varbinary"
          return: "varbinary"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varbinary"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "timestamp"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "double"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "date"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "varchar"
            - "bigint"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
        - args:
            - "integer"
            - "varchar"
          return: "varchar"
          rewrite: "CASE WHEN {0} IS NULL OR {1} IS NULL THEN NULL ELSE CONCAT({0}, {1}) END "
    - names:
        - "or"
      signatures:
        - args:
            - "boolean"
            - "boolean"
          return: "boolean"
    - names:
        - "abs"
      signatures:
        - args:
            - "integer"
          return: "integer"
        - args:
            - "double"
          return: "double"
        - args:
            - "bigint"
          return: "bigint"
        - args:
            - "float"
          return: "double"
    - names:
        - "acos"
      signatures:
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "asin"
      signatures:
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "atan"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "atan2"
      signatures:
        - args:
            - "bigint"
            - "float"
          return: "double"
        - args:
            - "double"
            - "double"
          return: "double"
        - args:
            - "double"
            - "bigint"
          return: "double"
        - args:
            - "bigint"
            - "integer"
          return: "double"
        - args:
            - "integer"
            - "bigint"
          return: "double"
        - args:
            - "integer"
            - "double"
          return: "double"
        - args:
            - "float"
            - "integer"
          return: "double"
        - args:
            - "float"
            - "float"
          return: "double"
        - args:
            - "double"
            - "float"
          return: "double"
        - args:
            - "integer"
            - "float"
          return: "double"
        - args:
            - "bigint"
            - "bigint"
          return: "double"
        - args:
            - "float"
            - "bigint"
          return: "double"
        - args:
            - "float"
            - "double"
          return: "double"
        - args:
            - "bigint"
            - "double"
          return: "double"
        - args:
            - "integer"
            - "integer"
          return: "double"
        - args:
            - "double"
            - "integer"
          return: "double"
    - names:
        - "cbrt"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "ceil"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "cos"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "cot"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "degrees"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "exp"
      signatures:
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "ln"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "mod"
      signatures:
        - args:
            - "double"
            - "double"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "double"
            - "bigint"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "integer"
            - "double"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "bigint"
            - "bigint"
          return: "bigint"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "integer"
            - "integer"
          return: "integer"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "bigint"
            - "double"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "bigint"
            - "integer"
          return: "integer"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "double"
            - "integer"
          return: "double"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
        - args:
            - "integer"
            - "bigint"
          return: "bigint"
          rewrite: "CASE WHEN {1} = 0 THEN NULL ELSE MOD({0}, {1}) END "
    - names:
        - "power"
      signatures:
        - args:
            - "bigint"
            - "float"
          return: "double"
        - args:
            - "bigint"
            - "integer"
          return: "double"
        - args:
            - "integer"
            - "bigint"
          return: "double"
        - args:
            - "integer"
            - "double"
          return: "double"
        - args:
            - "float"
            - "integer"
          return: "double"
        - args:
            - "float"
            - "float"
          return: "double"
        - args:
            - "double"
            - "double"
          return: "double"
        - args:
            - "integer"
            - "integer"
          return: "double"
        - args:
            - "double"
            - "float"
          return: "double"
        - args:
            - "double"
            - "integer"
          return: "double"
        - args:
            - "integer"
            - "float"
          return: "double"
    - names:
        - "radians"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "sin"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "sqrt"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "tan"
      signatures:
        - args:
            - "bigint"
          return: "double"
        - args:
            - "double"
          return: "double"
        - args:
            - "float"
          return: "double"
        - args:
            - "integer"
          return: "double"
    - names:
        - "char_length"
      signatures:
        - args:
            - "varchar"
          return: "integer"
    - names:
        - "character_length"
      signatures:
        - args:
            - "varchar"
          return: "integer"
    - names:
        - "lower"
      signatures:
        - args:
            - "varchar"
          return: "varchar"
    - names:
        - "replace"
      signatures:
        - args:
            - "varchar"
            - "varchar"
            - "varchar"
          return: "varchar"
    - names:
        - "substring"
      signatures:
        - args:
            - "varchar"
            - "integer"
            - "integer"
          return: "varchar"
    - names:
        - "substr"
      signatures:
        - args:
            - "varchar"
            - "integer"
            - "integer"
          return: "varchar"
    - names:
        - "substring"
      signatures:
        - args:
            - "varchar"
            - "integer"
          return: "varchar"
    - names:
        - "substr"
      signatures:
        - args:
            - "varchar"
            - "integer"
          return: "varchar"
    - names:
        - "upper"
      signatures:
        - args:
            - "varchar"
          return: "varchar"
  variable_length_operators:
    - names:
        - and
      variable_signatures:
        - return: boolean
          arg_type: boolean
    - names:
        - or
      variable_signatures:
        - return: boolean
          arg_type: boolean